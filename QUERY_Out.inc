DROP TABLE if exists `El_Gen`;
CREATE TABLE `El_Gen` (`Case1` TEXT,    `Y1`    TEXT,    `Y2`    TEXT,    `Area`  TEXT,    `Technology`    TEXT, `Season` TEXT, `Term` TEXT,    `Generation_MW`    REAL);
INSERT INTO EL_Gen(Case1, Y1, Y2, Area, Technology, Season, Term, Generation_MW) SELECT  VGE_T, VGE_T2, VGE_T3, VGE_T4, VGE_T5, VGE_T6, VGE_T7, level FROM VGE_T WHERE level >0;
DROP TABLE if exists `Electricity generation - Term`;
CREATE TABLE `Electricity generation - Term` (`Case` TEXT,    `Year1`    TEXT,    `Year2`    TEXT, `Country` TEXT, `Region` TEXT,   `Area`  TEXT, `Fuel` TEXT,   `Technology`    TEXT, `Season` TEXT, `Term` TEXT,    `MW`    REAL, `MWh`REAL, `GJ` REAL);
INSERT INTO `Electricity generation - Term`(`Case`, Year1, Year2, Country, Region, Area, Fuel, Technology, Season, Term, MW, MWh, GJ) SELECT [El_Gen].Case1 AS [Case], [El_Gen].Y1 AS [Year1], [El_Gen].Y2 AS [Year2], ICA.ICA3 AS Country, RRRAAA.RRRAAA3 AS Region, [El_Gen].Area AS Area, IGF.IGF4 AS Fuel, [El_Gen].Technology AS Technology, [El_Gen].Season AS Season, [El_Gen].Term AS Term, Sum([El_Gen].Generation_MW) AS MW, Sum([El_Gen].[Generation_MW]*[IHOURSINST].[value]) AS MWh, Sum([El_Gen].[Generation_MW]*[IHOURSINST].[value])*3.6 AS GJ FROM IHOURSINST INNER JOIN (((RRRAAA INNER JOIN [El_Gen] ON (RRRAAA.RRRAAA = [El_Gen].Case1) AND (RRRAAA.RRRAAA4 = [El_Gen].Area)) INNER JOIN ICA ON (ICA.ICA4 = [El_Gen].AREA) AND ([El_Gen].Case1 = ICA.ICA)) INNER JOIN IGF ON (IGF.IGF3 = [El_Gen].Technology) AND ([El_Gen].Case1 = IGF.IGF)) ON (IHOURSINST.IHOURSINST4 = [El_Gen].Term) AND (IHOURSINST.IHOURSINST3 = [El_Gen].Season) AND (IHOURSINST.IHOURSINST = [El_Gen].Case1) GROUP BY [El_Gen].Case1, [El_Gen].Y1,[El_Gen].Y2, ICA.ICA3, RRRAAA.RRRAAA3, [El_Gen].Area, IGF.IGF4, [El_Gen].Technology, [El_Gen].Season, [El_Gen].Term, [El_Gen].Generation_MW;
DROP TABLE if exists `Electricity generation - Annual`;
CREATE TABLE `Electricity generation - Annual` (`Case` TEXT,    `Year1`    TEXT,    `Year2`    TEXT, `Country` TEXT, `Region` TEXT,   `Area`  TEXT, `Fuel` TEXT,   `Technology`    TEXT,  `TWh`REAL, `PJ` REAL);
INSERT INTO `Electricity generation - annual`(`Case`, Year1, Year2, Country, Region, Area, Fuel, Technology, TWh, PJ)  SELECT [Electricity generation - Term].`Case`, [Electricity generation - Term].Year1, [Electricity generation - Term].Year2,[Electricity generation - Term].Country, [Electricity generation - Term].Region, [Electricity generation - Term].Area, [Electricity generation - Term].Fuel, [Electricity generation - Term].Technology, Sum([MWh]/1000000) AS TWh, Sum([GJ]/1000000) AS PJ FROM [Electricity generation - Term] GROUP BY [Electricity generation - Term].`Case`, [Electricity generation - Term].Year1,[Electricity generation - Term].Year2, [Electricity generation - Term].Country, [Electricity generation - Term].Region, [Electricity generation - Term].Area, [Electricity generation - Term].Fuel, [Electricity generation - Term].Technology;
DROP TABLE if exists `Electricity_price`;
CREATE TABLE `Electricity_price`(`Case1`TEXT, `Year1` TEXT, `Year2` TEXT, `Country` TEXT, `Region` TEXT, `Season` TEXT, `Term` TEXT, `OMONEY/MWh` REAL);
INSERT INTO `Electricity_price`(`Case1`,`Year1`,`Year2`,`Country`,`Region`,`Season`,`Term`,`OMONEY/MWh`) SELECT QEEQ.QEEQ AS [Case1], QEEQ.QEEQ2 AS [Year1],QEEQ.QEEQ3 AS [Year2], CCCRRR.CCCRRR AS Country, QEEQ.QEEQ4 AS Region, QEEQ.QEEQ5 AS Season, QEEQ.QEEQ5 AS Term, Avg([QEEQ].[marginal]/[IHOURSINST].[value]*[OMONEY].[value]) AS [OMONEY/MWh] FROM CCCRRR INNER JOIN (OMONEY INNER JOIN (QEEQ INNER JOIN IHOURSINST ON (QEEQ.QEEQ6 = IHOURSINST.IHOURSINST4) AND (QEEQ.QEEQ = IHOURSINST.IHOURSINST) AND (QEEQ.QEEQ5 = IHOURSINST.IHOURSINST3)) ON OMONEY.OMONEY = QEEQ.QEEQ) ON (CCCRRR.CCCRRR4 = QEEQ.QEEQ4) AND (CCCRRR.CCCRRR = QEEQ.QEEQ) GROUP BY QEEQ.QEEQ, QEEQ.QEEQ2, CCCRRR.CCCRRR3, QEEQ.QEEQ3, QEEQ.QEEQ4, QEEQ.QEEQ5, QEEQ.QEEQ6;
