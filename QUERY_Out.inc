DROP TABLE if exists `El_Gen`;
CREATE TABLE `El_Gen` (`Case1` TEXT,    `Y1`    TEXT,    `Y2`    TEXT,    `Area`  TEXT,    `Technology`    TEXT, `Season` TEXT, `Timestep` TEXT,    `Generation_MW`    REAL);
INSERT INTO EL_Gen(Case1, Y1, Y2, Area, Technology, Season, Timestep, Generation_MW) SELECT  VGE_T, VGE_T2, VGE_T3, VGE_T4, VGE_T5, VGE_T6, VGE_T7, level FROM VGE_T WHERE level >0;
DROP TABLE if exists `Electricity generation - Timestep`;
CREATE TABLE `Electricity generation - Timestep` (`Case` TEXT,    `Year1`    TEXT,    `Year2`    TEXT, `Country` TEXT, `Region` TEXT,   `Area`  TEXT, `Fuel` TEXT,   `Technology`    TEXT, `Season` TEXT, `Timestep` TEXT,    `MW`    REAL, `MWh`REAL, `GJ` REAL);
INSERT INTO `Electricity generation - Timestep`(`Case`, Year1, Year2, Country, Region, Area, Fuel, Technology, Season, Timestep, MW, MWh, GJ) SELECT [El_Gen].Case1 AS [Case], [El_Gen].Y1 AS [Year1], [El_Gen].Y2 AS [Year2], ICA.ICA3 AS Country, RRRAAA.RRRAAA3 AS Region, [El_Gen].Area AS Area, IGF.IGF4 AS Fuel, [El_Gen].Technology AS Technology, [El_Gen].Season AS Season, [El_Gen].Timestep AS Timestep, Sum([El_Gen].Generation_MW) AS MW, Sum([El_Gen].[Generation_MW]*[IHOURSINST].[value]) AS MWh, Sum([El_Gen].[Generation_MW]*[IHOURSINST].[value])*3.6 AS GJ FROM IHOURSINST INNER JOIN (((RRRAAA INNER JOIN [El_Gen] ON (RRRAAA.RRRAAA = [El_Gen].Case1) AND (RRRAAA.RRRAAA4 = [El_Gen].Area)) INNER JOIN ICA ON (ICA.ICA4 = [El_Gen].AREA) AND ([El_Gen].Case1 = ICA.ICA)) INNER JOIN IGF ON (IGF.IGF3 = [El_Gen].Technology) AND ([El_Gen].Case1 = IGF.IGF)) ON (IHOURSINST.IHOURSINST4 = [El_Gen].Timestep) AND (IHOURSINST.IHOURSINST3 = [El_Gen].Season) AND (IHOURSINST.IHOURSINST = [El_Gen].Case1) GROUP BY [El_Gen].Case1, [El_Gen].Y1,[El_Gen].Y2, ICA.ICA3, RRRAAA.RRRAAA3, [El_Gen].Area, IGF.IGF4, [El_Gen].Technology, [El_Gen].Season, [El_Gen].Timestep, [El_Gen].Generation_MW;
DROP TABLE if exists `Electricity generation - Annual`;
CREATE TABLE `Electricity generation - Annual` (`Case` TEXT,    `Year1`    TEXT,    `Year2`    TEXT, `Country` TEXT, `Region` TEXT,   `Area`  TEXT, `Fuel` TEXT,   `Technology`    TEXT,  `TWh`REAL, `PJ` REAL);
INSERT INTO `Electricity generation - annual`(`Case`, Year1, Year2, Country, Region, Area, Fuel, Technology, TWh, PJ)  SELECT [Electricity generation - timestep].`Case`, [Electricity generation - timestep].Year1, [Electricity generation - timestep].Year2,[Electricity generation - timestep].Country, [Electricity generation - timestep].Region, [Electricity generation - timestep].Area, [Electricity generation - timestep].Fuel, [Electricity generation - timestep].Technology, Sum([MWh]/1000000) AS TWh, Sum([GJ]/1000000) AS PJ FROM [Electricity generation - timestep] GROUP BY [Electricity generation - timestep].`Case`, [Electricity generation - timestep].Year1,[Electricity generation - timestep].Year2, [Electricity generation - timestep].Country, [Electricity generation - timestep].Region, [Electricity generation - timestep].Area, [Electricity generation - timestep].Fuel, [Electricity generation - timestep].Technology;
