DROP TABLE if exists `El_Gen`;
CREATE TABLE `El_Gen` (`Case1` TEXT,    `Y1`    TEXT,    `Y2`    TEXT,    `Area`  TEXT,    `Technology`    TEXT, `Season` TEXT, `Term` TEXT,    `Generation_MW`    REAL);
INSERT INTO EL_Gen(Case1, Y1, Y2, Area, Technology, Season, Term, Generation_MW) SELECT  VGE_T, VGE_T2, VGE_T3, VGE_T4, VGE_T5, VGE_T6, VGE_T7, level FROM VGE_T WHERE level >0;
DROP TABLE if exists `Electricity generation - Term`;
CREATE TABLE `Electricity generation - Term` (`Case` TEXT,    `Year1`    TEXT,    `Year2`    TEXT, `Country` TEXT, `Region` TEXT,   `Area`  TEXT, `Fuel` TEXT,   `Technology`    TEXT, `Season` TEXT, `Term` TEXT,    `MW`    REAL, `MWh`REAL, `GJ` REAL);
INSERT INTO `Electricity generation - Term`(`Case`, Year1, Year2, Country, Region, Area, Fuel, Technology, Season, Term, MW, MWh, GJ) SELECT [El_Gen].Case1 AS [Case], [El_Gen].Y1 AS [Year1], [El_Gen].Y2 AS [Year2], ICA.ICA3 AS Country, RRRAAA.RRRAAA3 AS Region, [El_Gen].Area AS Area, IGF.IGF4 AS Fuel, [El_Gen].Technology AS Technology, [El_Gen].Season AS Season, [El_Gen].Term AS Term, Sum([El_Gen].Generation_MW) AS MW, Sum([El_Gen].[Generation_MW]*[IHOURSINST].[value]) AS MWh, Sum([El_Gen].[Generation_MW]*[IHOURSINST].[value])*3.6 AS GJ FROM IHOURSINST INNER JOIN (((RRRAAA INNER JOIN [El_Gen] ON (RRRAAA.RRRAAA = [El_Gen].Case1) AND (RRRAAA.RRRAAA4 = [El_Gen].Area)) INNER JOIN ICA ON (ICA.ICA4 = [El_Gen].AREA) AND ([El_Gen].Case1 = ICA.ICA)) INNER JOIN IGF ON (IGF.IGF3 = [El_Gen].Technology) AND ([El_Gen].Case1 = IGF.IGF)) ON (IHOURSINST.IHOURSINST4 = [El_Gen].Term) AND (IHOURSINST.IHOURSINST3 = [El_Gen].Season) AND (IHOURSINST.IHOURSINST = [El_Gen].Case1) GROUP BY [El_Gen].Case1, [El_Gen].Y1,[El_Gen].Y2, ICA.ICA3, RRRAAA.RRRAAA3, [El_Gen].Area, IGF.IGF4, [El_Gen].Technology, [El_Gen].Season, [El_Gen].Term, [El_Gen].Generation_MW;
DROP TABLE if exists `Electricity generation - Annual`;
CREATE TABLE `Electricity generation - Annual` (`Case` TEXT,    `Year1`    TEXT,    `Year2`    TEXT, `Country` TEXT, `Region` TEXT,   `Area`  TEXT, `Fuel` TEXT,   `Technology`    TEXT,  `TWh`REAL, `PJ` REAL);
INSERT INTO `Electricity generation - annual`(`Case`, Year1, Year2, Country, Region, Area, Fuel, Technology, TWh, PJ)  SELECT [Electricity generation - Term].`Case`, [Electricity generation - Term].Year1, [Electricity generation - Term].Year2,[Electricity generation - Term].Country, [Electricity generation - Term].Region, [Electricity generation - Term].Area, [Electricity generation - Term].Fuel, [Electricity generation - Term].Technology, Sum([MWh]/1000000) AS TWh, Sum([GJ]/1000000) AS PJ FROM [Electricity generation - Term] GROUP BY [Electricity generation - Term].`Case`, [Electricity generation - Term].Year1,[Electricity generation - Term].Year2, [Electricity generation - Term].Country, [Electricity generation - Term].Region, [Electricity generation - Term].Area, [Electricity generation - Term].Fuel, [Electricity generation - Term].Technology;
DROP TABLE if exists `Electricity_price`;
CREATE TABLE `Electricity_price`(`Case1`TEXT, `Year1` TEXT, `Year2` TEXT, `Country` TEXT, `Region` TEXT, `Season` TEXT, `Term` TEXT, `OMONEY/MWh` REAL);
INSERT INTO `Electricity_price`(`Case1`,`Year1`,`Year2`,`Country`,`Region`,`Season`,`Term`,`OMONEY/MWh`) SELECT QEEQ.QEEQ AS [Case1], QEEQ.QEEQ2 AS [Year1],QEEQ.QEEQ3 AS [Year2], CCCRRR.CCCRRR AS Country, QEEQ.QEEQ4 AS Region, QEEQ.QEEQ5 AS Season, QEEQ.QEEQ6 AS Term, Avg([QEEQ].[marginal]/[IHOURSINST].[value]*[OMONEY].[value]) AS [OMONEY/MWh] FROM CCCRRR INNER JOIN (OMONEY INNER JOIN (QEEQ INNER JOIN IHOURSINST ON (QEEQ.QEEQ6 = IHOURSINST.IHOURSINST4) AND (QEEQ.QEEQ = IHOURSINST.IHOURSINST) AND (QEEQ.QEEQ5 = IHOURSINST.IHOURSINST3)) ON OMONEY.OMONEY = QEEQ.QEEQ) ON (CCCRRR.CCCRRR4 = QEEQ.QEEQ4) AND (CCCRRR.CCCRRR = QEEQ.QEEQ) GROUP BY QEEQ.QEEQ, QEEQ.QEEQ2, CCCRRR.CCCRRR3, QEEQ.QEEQ3, QEEQ.QEEQ4, QEEQ.QEEQ5, QEEQ.QEEQ6;
DROP TABLE if exists `Heat_Gen`;
CREATE TABLE `Heat_Gen` (`Case1` TEXT,    `Y1`    TEXT,    `Y2`    TEXT,    `Area`  TEXT,    `Technology`    TEXT, `Season` TEXT, `Term` TEXT,    `Generation_MW`    REAL);
INSERT INTO Heat_Gen(Case1, Y1, Y2, Area, Technology, Season, Term, Generation_MW) SELECT  VGH_T, VGH_T2, VGH_T3, VGH_T4, VGH_T5, VGH_T6, VGH_T7, level FROM VGH_T WHERE level >0;
DROP TABLE if exists `Heat Generation - Term`;
CREATE TABLE `Heat Generation - Term` (`Case` TEXT,    `Year1`    TEXT,    `Year2`    TEXT, `Country` TEXT, `Region` TEXT,   `Area`  TEXT, `Fuel` TEXT,   `Technology`    TEXT, `Season` TEXT, `Term` TEXT,    `MW`    REAL, `MWh`REAL, `GJ` REAL);
INSERT INTO `Heat generation - Term`(`Case`, Year1, Year2, Country, Region, Area, Fuel, Technology, Season, Term, MW, MWh, GJ) SELECT [Heat_Gen].Case1 AS [Case], [Heat_Gen].Y1 AS [Year1], [Heat_Gen].Y2 AS [Year2], ICA.ICA3 AS Country, RRRAAA.RRRAAA3 AS Region, [Heat_Gen].Area AS Area, IGF.IGF4 AS Fuel, [Heat_Gen].Technology AS Technology, [Heat_Gen].Season AS Season, [Heat_Gen].Term AS Term, Sum([Heat_Gen].Generation_MW) AS MW, Sum([Heat_Gen].[Generation_MW]*[IHOURSINST].[value]) AS MWh, Sum([Heat_Gen].[Generation_MW]*[IHOURSINST].[value])*3.6 AS GJ FROM IHOURSINST INNER JOIN (((RRRAAA INNER JOIN [Heat_Gen] ON (RRRAAA.RRRAAA = [Heat_Gen].Case1) AND (RRRAAA.RRRAAA4 = [Heat_Gen].Area)) INNER JOIN ICA ON (ICA.ICA4 = [Heat_Gen].AREA) AND ([Heat_Gen].Case1 = ICA.ICA)) INNER JOIN IGF ON (IGF.IGF3 = [Heat_Gen].Technology) AND ([Heat_Gen].Case1 = IGF.IGF)) ON (IHOURSINST.IHOURSINST4 = [Heat_Gen].Term) AND (IHOURSINST.IHOURSINST3 = [Heat_Gen].Season) AND (IHOURSINST.IHOURSINST = [Heat_Gen].Case1) GROUP BY [Heat_Gen].Case1, [Heat_Gen].Y1,[Heat_Gen].Y2, ICA.ICA3, RRRAAA.RRRAAA3, [Heat_Gen].Area, IGF.IGF4, [Heat_Gen].Technology, [Heat_Gen].Season, [Heat_Gen].Term, [Heat_Gen].Generation_MW;
DROP TABLE if exists `Heat Generation - Annual`;
CREATE TABLE `Heat Generation - Annual` (`Case` TEXT,    `Year1`    TEXT,    `Year2`    TEXT, `Country` TEXT, `Region` TEXT,   `Area`  TEXT, `Fuel` TEXT,   `Technology`    TEXT,  `TWh`REAL, `PJ` REAL);
INSERT INTO `Heat Generation - Annual`(`Case`, Year1, Year2, Country, Region, Area, Fuel, Technology, TWh, PJ)  SELECT [Heat Generation - Term].`Case`, [Heat Generation - Term].Year1, [Heat Generation - Term].Year2,[Heat Generation - Term].Country, [Heat Generation - Term].Region, [Heat Generation - Term].Area, [Heat Generation - Term].Fuel, [Heat Generation - Term].Technology, Sum([MWh]/1000000) AS TWh, Sum([GJ]/1000000) AS PJ FROM [Heat Generation - Term] GROUP BY [Heat Generation - Term].`Case`, [Heat Generation - Term].Year1,[Heat Generation - Term].Year2, [Heat Generation - Term].Country, [Heat Generation - Term].Region, [Heat Generation - Term].Area, [Heat Generation - Term].Fuel, [Heat Generation - Term].Technology;
DROP TABLE if exists `Fuel_Con`;
CREATE TABLE `Fuel_Con`(`Case1` TEXT, `Year1`TEXT, `Year2` TEXT, `Area` TEXT, `Technology` TEXT, `Season` TEXT, `Term` TEXT, `MW`  REAL);
INSERT INTO Fuel_Con(Case1, Year1, Year2, Area, Technology, Season,Term, MW) SELECT  VGF_T, VGF_T2, VGF_T3, VGF_T4, VGF_T5, VGF_T6, VGF_T7, level FROM VGF_T WHERE level >0;
DROP TABLE if exists `Fuel Consumption - Term`;
CREATE TABLE `Fuel Consumption - Term` (`Case` TEXT,    `Year1`    TEXT,    `Year2`    TEXT, `Country` TEXT, `Region` TEXT,   `Area`  TEXT, `Fuel` TEXT,   `Technology`    TEXT, `Season` TEXT, `Term` TEXT,    `MJ/s`    REAL, `MWh`REAL, `GJ` REAL);
INSERT INTO `Fuel Consumption - Term`(`Case`, Year1, Year2, Country, Region, Area, Fuel, Technology, Season, Term,`MJ/s`, MWh, GJ) SELECT Fuel_Con.Case1 AS `Case`, Fuel_Con.Year1 AS Year1, Fuel_Con.Year2 AS Year2, ICA.ICA3 AS Country, RRRAAA.RRRAAA3 AS Region, Fuel_Con.Area AS Area, IGF.IGF4 AS `Fuel`, Fuel_Con.Technology AS Technology, Fuel_Con.Season AS Season, Fuel_Con.Term AS Term, Sum([Fuel_Con].MW) AS `MJ/s`, Sum([Fuel_Con].[MW]*[IHOURSINST].[value]) AS MWh, Sum([Fuel_Con].[MW]*[IHOURSINST].[value])*3.6 AS GJ FROM IGF INNER JOIN (IHOURSINST INNER JOIN (RRRAAA INNER JOIN (ICA INNER JOIN [Fuel_Con] ON (ICA.ICA4 = [Fuel_Con].Area) AND (ICA.ICA = [Fuel_Con].Case1)) ON (RRRAAA.RRRAAA4 = [Fuel_Con].Area) AND (RRRAAA.RRRAAA = [Fuel_Con].Case1)) ON (IHOURSINST.IHOURSINST4 = [Fuel_Con].Term) AND (IHOURSINST.IHOURSINST3 = [Fuel_Con].Season) AND (IHOURSINST.IHOURSINST = [Fuel_Con].Case1)) ON (IGF.IGF3 = [Fuel_Con].Technology) AND (IGF.IGF = [Fuel_Con].Case1)GROUP BY [Fuel_Con].Case1, [Fuel_Con].Year1,[Fuel_Con].Year2, ICA.ICA3, RRRAAA.RRRAAA3, [Fuel_Con].Area, IGF.IGF4, [Fuel_Con].Technology, [Fuel_Con].Season, [Fuel_Con].Term;
DROP TABLE if exists `Fuel Consumption - Annual`;
CREATE TABLE `Fuel Consumption - Annual` (`Case` TEXT,    `Year1`    TEXT,    `Year2`    TEXT, `Country` TEXT, `Region` TEXT,   `Area`  TEXT, `Fuel` TEXT,   `Technology`    TEXT,  `TWh`REAL, `PJ` REAL);
INSERT INTO `Fuel Consumption - Annual`(`Case`, Year1, Year2, Country, Region, Area, Fuel, Technology, TWh, PJ)  SELECT [Fuel Consumption - Term].`Case`, [Fuel Consumption - Term].Year1, [Fuel Consumption - Term].Year2,[Fuel Consumption - Term].Country, [Fuel Consumption - Term].Region, [Fuel Consumption - Term].Area, [Fuel Consumption - Term].Fuel, [Fuel Consumption - Term].Technology, Sum([MWh]/1000000) AS TWh, Sum([GJ]/1000000) AS PJ FROM [Fuel Consumption - Term] GROUP BY [Fuel Consumption - Term].`Case`, [Fuel Consumption - Term].Year1,[Fuel Consumption - Term].Year2, [Fuel Consumption - Term].Country, [Fuel Consumption - Term].Region, [Fuel Consumption - Term].Area, [Fuel Consumption - Term].Fuel, [Fuel Consumption - Term].Technology;
DROP TABLE if exists `Emissions - Term`;
CREATE TABLE `Emissions - Term`(`Case` TEXT, `Year1`TEXT, `Year2` TEXT,`Country` TEXT, `Region` TEXT, `Area` TEXT,`Fuel` TEXT, `Technology` TEXT, `Season` TEXT, `Term` TEXT, `CO2 t/h`  REAL,`CO2 tons`  REAL, `SO2 t/h`  REAL,`SO2 tons`  REAL, `N2O t/h`  REAL,`N2O tons`  REAL);
INSERT INTO `Emissions - Term`(`Case`,Year1,Year2,Country,Region,Area,`Fuel`,Technology,Season, `Term`, `CO2 t/h`,`CO2 tons`, `SO2 t/h`,`SO2 tons`, `N2O t/h`,`N2O tons`) SELECT Fuel_con.Case1 AS `Case`, Fuel_con.Year1 AS Year1, Fuel_con.Year2 AS Year2, ICA.ICA3 AS Country, RRRAAA.RRRAAA3 AS Region, Fuel_con.Area AS Area, IGF.IGF4 AS Fuel, Fuel_con.Technology AS Technology, Fuel_con.Season AS Season, Fuel_con.Term AS Term, Sum([Fuel_con].[MW]*[IM_CO2].[value])*3.6/1000 AS `CO2 t/h`, Sum([Fuel_con].[MW]*[IHOURSINST].[value]*[IM_CO2].[value])*3.6/1000 AS `CO2 tons`,Sum([Fuel_con].[MW]*[IM_SO2].[value])*3.6/1000 AS `SO2 t/h`, Sum([Fuel_con].[MW]*[IHOURSINST].[value]*[IM_SO2].[value])*3.6/1000 AS `SO2 tons`,Sum([Fuel_con].[MW]*[IM_N2O].[value])*3.6/1000 AS `N2O t/h`, Sum([Fuel_con].[MW]*[IHOURSINST].[value]*[IM_N2O].[value])*3.6/1000 AS `N2O tons`FROM (IGF INNER JOIN (IHOURSINST INNER JOIN (RRRAAA INNER JOIN (ICA INNER JOIN [Fuel_con] ON (ICA.ICA4 = [Fuel_con].Area) AND (ICA.ICA = [Fuel_con].Case1)) ON (RRRAAA.RRRAAA4 = [Fuel_con].Area) AND (RRRAAA.RRRAAA = [Fuel_con].Case1)) ON (IHOURSINST.IHOURSINST4 = [Fuel_con].Term) AND (IHOURSINST.IHOURSINST3 = [Fuel_con].Season) AND (IHOURSINST.IHOURSINST = [Fuel_con].Case1)) ON (IGF.IGF3 = [Fuel_con].Technology) AND (IGF.IGF = [Fuel_con].Case1)) INNER JOIN IM_SO2 ON (IM_SO2.IM_SO23 = [Fuel_con].Technology) AND ([Fuel_con].Case1 = IM_SO2.IM_SO2) INNER JOIN IM_CO2 ON (IM_CO2.IM_CO23 = [Fuel_con].Technology) AND ([Fuel_con].Case1 = IM_CO2.IM_CO2) INNER JOIN IM_N2O ON (IM_N2O.IM_N2O3 = [Fuel_con].Technology) AND ([Fuel_con].Case1 = IM_N2O.IM_N2O)GROUP BY [Fuel_con].Case1, [Fuel_con].Year1,Fuel_con.Year2, ICA.ICA3, RRRAAA.RRRAAA3, [Fuel_con].Area, IGF.IGF4, [Fuel_con].Technology, [Fuel_con].Season, [Fuel_con].Term;
DROP TABLE if exists `Emissions - Annual`;
CREATE TABLE `Emissions - Annual`(`Case` TEXT, `Year1`TEXT, `Year2` TEXT,`Country` TEXT, `Region` TEXT, `Area` TEXT,`Fuel` TEXT, `Technology` TEXT,`CO2 kilotons`  REAL,`CO2 megatons`  REAL, `SO2 kilotons`  REAL,`SO2 megatons`  REAL, `N2O kilotons`  REAL,`N2O megatons`  REAL);
INSERT INTO `Emissions - Annual`(`Case`,Year1,Year2,Country,Region, Area,Fuel,Technology,`CO2 kilotons`,`CO2 megatons`, `SO2 kilotons`,`SO2 megatons`, `N2O kilotons`,`N2O megatons`) SELECT [Emissions - Term].`Case`, [Emissions - Term].Year1, [Emissions - Term].Year2, [Emissions - Term].Country, [Emissions - Term].Region, [Emissions - Term].Area, [Emissions - Term].Fuel, [Emissions - Term].Technology, Sum([CO2 Tons]/1000) AS `CO2 kilotons`, Sum([CO2 Tons]/1000000) AS `CO2 megatons`, Sum([SO2 Tons]/1000) AS `SO2 kilotons`, Sum([SO2 Tons]/1000000) AS `SO2 megatons`, Sum([N2O Tons]/1000) AS `N2O kilotons`, Sum([N2O Tons]/1000000) AS `N2O megatons` FROM [Emissions - Term] GROUP BY [Emissions - Term].`Case`, [Emissions - Term].Year1, [Emissions - Term].Year2, [Emissions - Term].Country, [Emissions - Term].Region, [Emissions - Term].Area, [Emissions - Term].Fuel, [Emissions - Term].Technology;
